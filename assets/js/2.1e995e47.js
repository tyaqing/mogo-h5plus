(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{159:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"hotfix-项目地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hotfix-项目地址","aria-hidden":"true"}},[t._v("#")]),t._v(" Hotfix "),a("a",{attrs:{href:"https://github.com/tyaqing/hotfix",target:"_blank",rel:"noopener noreferrer"}},[t._v("项目地址"),a("OutboundLink")],1)]),a("p",[t._v("热更新能够不提交应用商店审核而修改 APP 内容,使得 app 的迭代变的非常灵活.")]),t._m(0),a("table",[t._m(1),a("tbody",[a("tr",[a("td",[a("img",{attrs:{width:"400",src:t.$withBase("/IMG_0040.PNG"),alt:"foo"}})]),a("td",[a("img",{attrs:{width:"400",src:t.$withBase("/S80805-211149.jpg"),alt:"foo"}})]),a("td",[a("img",{attrs:{width:"400",src:t.$withBase("/S80806-112100.jpg"),alt:"foo"}})])])])]),t._m(2),a("p",[t._v("在使用热更新前,请看完这份介绍再使用.")]),t._m(3),a("p",[t._v("对于安卓来说,热更新是没有任何问题的,但是苹果您可以看下面这段话.")]),t._m(4),t._m(5),t._m(6),t._m(7),a("p",[t._v("安装更新在这里指的就是更新大版本,比如添加了模块,必须重新安装.")]),t._m(8),t._m(9),t._m(10),t._m(11),t._m(12),t._m(13),t._m(14),t._m(15),t._m(16),a("p",[t._v("然后加载使用.")]),t._m(17),t._m(18),a("p",[t._v("这种用于没有使用脚手架的开发者")]),t._m(19),t._m(20),a("p",[t._v("热更新分为两种,在 ios 和安卓都可以使用:")]),t._m(21),t._m(22),t._m(23),t._m(24),t._m(25),t._m(26),t._m(27),t._m(28),t._m(29),t._m(30),t._m(31),t._m(32)])},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[a("code",[t._v("MogoH5+")]),t._v("在"),a("code",[t._v("1.3.0")]),t._v("后加入了"),a("code",[t._v("热更新/安装更新")]),t._v("的集成.同时,我们的"),a("code",[t._v("热更新服务器")]),t._v("也在内测中,将在不久公测使用.您无需后端就可以完成整个软件的"),a("code",[t._v("热更新/安装更新")]),t._v("服务.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("thead",[s("tr",[s("th",[this._v("iphone 热更新 效果如下")]),s("th",[this._v("安卓热更新效果如下")]),s("th",[this._v("安卓安装更新如下")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#介绍","aria-hidden":"true"}},[this._v("#")]),this._v(" 介绍")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"热更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#热更新","aria-hidden":"true"}},[this._v("#")]),this._v(" 热更新")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"app-store-应用更新说明-引自-dcloud"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#app-store-应用更新说明-引自-dcloud","aria-hidden":"true"}},[this._v("#")]),this._v(" App store 应用更新说明(引自 dcloud)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("应用资源更新肯定是违反 apple 政策的，但目前看起来它也不管。你在官网案例那里下载 Appstore 版本的那些 app，大多启动后都会提示更新，反正也都没下架。如果你不是很大的公司，apple 不会理睬你。如果你是大公司，建议不要做整体更新，每次更新几个页面，也不要提示更新后需要重启，这样会安全点。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("作者本人的实践中也经常使用热更新,名声不大,不频繁基本上可以自由使用.\n同样,我们加入了"),s("code",[this._v("静默更新")]),this._v("这种比较无脑的更新.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"安装更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装更新","aria-hidden":"true"}},[this._v("#")]),this._v(" 安装更新")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"在安卓的安装更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在安卓的安装更新","aria-hidden":"true"}},[this._v("#")]),this._v(" 在安卓的安装更新")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("可以让 APP 提示,然后用户选择自己下载安装")]),s("li",[this._v("应用商店更新")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"在苹果的安装更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在苹果的安装更新","aria-hidden":"true"}},[this._v("#")]),this._v(" 在苹果的安装更新")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("必须提交 AppStore 提交审核")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在这里顺便提一下,苹果用户的习惯一般是自己主动更新.\n在苹果应用商店的大厂 app (微信,淘宝,京东) 更新几乎不会受到 app 的更新推送,也没有所谓"),s("code",[this._v("检查更新")]),this._v("的功能,也就是说,更新是用户主动操作的.我们的"),s("code",[this._v("迭代")]),this._v("同样也遵循这条"),s("code",[this._v("行规")]),this._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"引入方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#引入方式","aria-hidden":"true"}},[this._v("#")]),this._v(" 引入方式")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("可以在"),s("code",[this._v("main.js")]),this._v("中添加"),s("code",[this._v("checkUpdate(URL);")]),this._v(",打开 app 就会自动检测.还可以放在"),s("code",[this._v("检查更新")]),this._v("的按钮上触发.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"es6-module-引入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#es6-module-引入","aria-hidden":"true"}},[this._v("#")]),this._v(" ES6 Module 引入")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("首先在"),s("code",[this._v("page.json")]),this._v("把用到"),s("code",[this._v("checkUpdate")]),this._v("的页面加上管道"),s("code",[this._v("|plusReady")]),this._v(".")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" checkUpdate "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"./utils/hotfix"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token function"}},[t._v("checkUpdate")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token constant"}},[t._v("URL")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// 填入您检查api的url地址")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"script-方式引入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#script-方式引入","aria-hidden":"true"}},[this._v("#")]),s("code",[this._v("<script>")]),this._v("方式引入")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("APP"),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("html5plus://ready"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{attrs:{class:"token script language-javascript"}}),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  // 这段必须加载title底下\n....\n"),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("path/hotfix-bs.js"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{attrs:{class:"token script language-javascript"}}),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{attrs:{class:"token script language-javascript"}},[t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("checkUpdate")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'https://api.hotfix.femirror.com/public/app/checkUpdate?bundleId=你的appId'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// 填入您检查api的url地址")]),t._v("\n")]),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"热更新配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#热更新配置","aria-hidden":"true"}},[this._v("#")]),this._v(" 热更新配置")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("静默更新 : 使用"),s("code",[this._v("checkUpdate")]),this._v("方法后检查更新,如果有更新会自动下载 app,整个过程没有任何提示,用户第二次打开 app 就会出现更新后的效果.")]),s("li",[this._v("提示更新 : 使用"),s("code",[this._v("checkUpdate")]),this._v("方法后检查更新,如果有则会弹出确认框,用户确认后会提示正在下载,正在安装,安装完成重启,更新完成等提示.")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("如果您更新后不想立即重启,可以注释掉"),s("code",[this._v("hotfix.js")]),this._v("中的函数"),s("code",[this._v("plus.runtime.restart();")]),this._v(",这样,app 会在用户第二打开的时候自动完成更新.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"后端接收的数据格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#后端接收的数据格式","aria-hidden":"true"}},[this._v("#")]),this._v(" 后端接收的数据格式")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("checkUpdate(url)")]),this._v(" 是以 "),s("code",[this._v("POST")]),this._v(" 去访问 URL 的.数据类型为"),s("code",[this._v("application/json")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),a("th",[t._v("描述")]),a("th",[t._v("类型")])])]),a("tbody",[a("tr",[a("td",[t._v("version")]),a("td",[t._v("app 当前的版本 ,如 2.1.0")]),a("td",[t._v("string")])]),a("tr",[a("td",[t._v("os")]),a("td",[t._v("app 设备的系统信息 比如系统版本")]),a("td",[t._v("json")])]),a("tr",[a("td",[t._v("device")]),a("td",[t._v("app 设备的设备信息 比如 uuid")]),a("td",[t._v("json")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"后端返回的数据格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#后端返回的数据格式","aria-hidden":"true"}},[this._v("#")]),this._v(" 后端返回的数据格式")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("下面是一个完整的数据返回 返回格式为"),s("code",[this._v("application/json")]),this._v(" ,返回状态码为"),s("code",[this._v("200")]),this._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("注意 : 返回"),s("code",[this._v("200")]),this._v("以外的状态码将不被处理,如果想自行处理可以改写代码")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),a("th",[t._v("描述")]),a("th",[t._v("参数")])])]),a("tbody",[a("tr",[a("td",[t._v("name")]),a("td",[t._v("版本号 如果检测的版本大于本地版本就会更新")]),a("td",[t._v("string")])]),a("tr",[a("td",[t._v("title")]),a("td",[t._v("升级提示标题")]),a("td",[t._v("string")])]),a("tr",[a("td",[t._v("description")]),a("td",[t._v("升级提示内容")]),a("td",[t._v("string")])]),a("tr",[a("td",[t._v("platform")]),a("td",[t._v("符合升级的平台 ios:升级苹果 android:升级安卓 both:都更新")]),a("td",[a("code",[t._v("ios")]),t._v(" ,"),a("code",[t._v("android")]),t._v(", "),a("code",[t._v("both")])])]),a("tr",[a("td",[t._v("type")]),a("td",[t._v("安装类型 wgt:热更新 apk:安装更新")]),a("td",[a("code",[t._v("wgt")]),t._v(","),a("code",[t._v("apk")])])]),a("tr",[a("td",[t._v("hotupdate_type")]),a("td",[t._v("更新提示 silence:静默更新 tip:提示更新 (apk 的安装是需要提示的)")]),a("td",[a("code",[t._v("silence")]),t._v(","),a("code",[t._v("tip")])])]),a("tr",[a("td",[t._v("android_url")]),a("td",[t._v("更新下载地址 以"),a("code",[t._v(".apk")]),t._v(","),a("code",[t._v(".wgt")]),t._v("结尾的 http 地址")]),a("td",[t._v("url")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("下面这段"),s("code",[this._v("json")]),this._v("可以表达为:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("更新平台为 "),s("code",[this._v("全部平台")])]),s("li",[s("code",[this._v("热更新")])]),s("li",[s("code",[this._v("提示更新")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"name"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"2.2.1"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"title"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"发现新版本,快来使用吧!"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"description"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"1.增加了....\\n 2.修复了... 3.杀了一个程序员祭天"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"platform"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"both"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"type"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"wgt"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"hotupdate_type"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"tip"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"android_url"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"http://cdn.femirror.com/H5FD926B1.wgt"')]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])}],!1,null,null,null);s.default=n.exports}}]);